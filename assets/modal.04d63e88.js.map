{"version":3,"file":"modal.04d63e88.js","sources":["../../src/components/FMessageModal/FMessageModal.tsx","../../src/plugins/modal.ts"],"sourcesContent":["import { defineComponent, PropType, ref } from \"vue\";\nimport { useLocale } from \"vuetify\";\n\nimport type { VNode } from \"vue\";\n\nimport { VCard, VCardText, VCardTitle, VIcon } from \"vuetify/components\";\nimport { FModal } from \"../FModal\";\nimport { FButton } from \"../FButton\";\n\nimport \"./FMessageModal.scss\";\n\nexport interface ModalAction {\n  show?: boolean;\n  text?: string;\n  props?: Record<string, any>;\n  classes?: Record<string, any>;\n  callback?: (...args: any) => void;\n}\n\nexport const FMessageModal = defineComponent({\n  name: \"FMessageModal\",\n\n  props: {\n    title: {\n      type: String as PropType<String | VNode>,\n      default: \"\",\n    },\n    text: {\n      type: String as PropType<String | VNode>,\n      default: \"\",\n    },\n    cancel: {\n      type: Object as PropType<ModalAction>,\n      default: {},\n    },\n    confirm: {\n      type: Object as PropType<ModalAction>,\n      default: {},\n    },\n    actions: {\n      type: Object as PropType<ModalAction[]>,\n      default: {},\n    },\n    type: {\n      type: String,\n      default: \"\",\n    },\n  },\n\n  emits: {\n    destroy: () => true,\n  },\n\n  setup(props, { slots, emit, expose }) {\n    const { t } = useLocale();\n    const dialog = ref(false);\n\n    const genAction = (action: ModalAction) => {\n      if (!action.show) {\n        return null;\n      }\n\n      return (\n        <FButton\n          {...(action.props || {})}\n          class={action.classes || \"\"}\n          onClick={() => {\n            dialog.value = false;\n            action.callback && action.callback();\n          }}\n        >\n          {action.text}\n        </FButton>\n      );\n    };\n\n    const genActions = () => {\n      if (props?.actions.length > 0) {\n        return props.actions.map((action) => genAction(action));\n      }\n\n      const cancel = {\n        show: true,\n        text: t(\"$vuetify.uikit.cancel\"),\n        props: { text: true },\n        ...(props?.cancel || {}),\n      };\n\n      const confirm = {\n        show: true,\n        text: t(\"$vuetify.uikit.continue\"),\n        props: { color: \"greyscale_1\" },\n        ...(props?.confirm || {}),\n      };\n\n      const btns = () => (\n        <>\n          {genAction(cancel)}\n          {genAction(confirm)}\n        </>\n      );\n\n      return btns();\n    };\n\n    const show = () => {\n      dialog.value = true;\n    };\n\n    const close = () => {\n      dialog.value = false;\n      emit(\"destroy\");\n    };\n\n    expose({ show, close });\n\n    const content = () => (\n      <VCard class=\"f-msg-modal__body\" variant=\"flat\">\n        {props.title && (\n          <VCardTitle class=\"pt-8 pb-6\">\n            {props.type === \"warning\" && (\n              <VIcon class=\"mr-2\" color=\"error\">\n                $warning\n              </VIcon>\n            )}\n            {props.title}\n          </VCardTitle>\n        )}\n        {props.text && <VCardText color=\"greyscale_3\">{props.text}</VCardText>}\n        <div class=\"d-flex justify-space-around pb-3\">{genActions()}</div>\n      </VCard>\n    );\n\n    return () => (\n      <FModal class=\"f-msg-modal\" hideClose modelValue={dialog.value}>\n        {{\n          default: () => content(),\n        }}\n      </FModal>\n    );\n  },\n});\n","import { createVNode, nextTick, render, getCurrentInstance } from \"vue\";\n\nimport type { App, VNode } from \"vue\";\nimport { FMessageModal, ModalAction } from \"../components/FMessageModal/FMessageModal\";\n\nexport interface MessageModalProps {\n  title?: string | VNode;\n  text?: string | VNode;\n  props?: Record<string, any>;\n  cancel?: ModalAction;\n  confirm?: ModalAction;\n  actions?: ModalAction[];\n  type?: string;\n}\n\nexport function useModal() {\n  const instance = getCurrentInstance()!;\n\n  return instance.appContext.config.globalProperties.$uikit.modal;\n}\n\nexport type Keys = \"warning\" | \"show\" | \"clear\";\n\nexport type ModalMethods = Record<\n  Keys,\n  (options?: MessageModalProps) => void\n>;\n\nfunction install(app: App) {\n  let instance: VNode | null = null;\n\n  const show = (options: MessageModalProps) => {\n    if (instance) {\n      instance.component!.exposed!.close();\n    }\n\n    nextTick(() => {\n      const appendTo = document.querySelector(\"[data-v-app]\");\n      const container = document.createElement(\"div\");\n      const vnode = createVNode(FMessageModal, {\n        ...options,\n        attach: container,\n        onDestroy: () => {\n          render(null, container);\n          instance = null;\n          appendTo?.removeChild(container);\n        },\n      });\n\n      vnode.appContext = app._context!;\n      render(vnode, container);\n      appendTo?.appendChild(container);\n      instance = vnode;\n\n      instance.component!.exposed!.show();\n    });\n  };\n\n  const clear = () => {\n    if (!instance) return;\n\n    instance!.component!.exposed!.close();\n  };\n\n  const modal = { show, clear };\n  const properties = app.config.globalProperties;\n\n  properties.$uikit = properties.$uikit || {};\n  properties.$uikit.modal = modal as ModalMethods;\n}\n\nexport function Modal() {}\n\nModal.install = install;\n"],"names":["FMessageModal","defineComponent","name","props","title","type","String","default","text","cancel","Object","confirm","actions","emits","destroy","setup","slots","emit","expose","t","useLocale","dialog","ref","genAction","action","show","_createVNode","FButton","_mergeProps","classes","value","callback","genActions","__name","length","map","color","close","content","VCard","VCardTitle","VIcon","_createTextVNode","VCardText","FModal","useModal","getCurrentInstance","install","app","instance","modal","options","nextTick","appendTo","container","vnode","createVNode","render","properties","Modal"],"mappings":"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"}